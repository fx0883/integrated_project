<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>统计分析 - 自律打卡</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="enhanced-style.css">
    <style>
        :root {
            /* 扁平化色调 */
            --primary-color: #4CD964;
            --primary-dark: #009688;
            --primary-light: #E0F2F1;
            --accent-color: #FF9800;
            --accent-light: #FFE0B2;
            --highlight: #FFEB3B;
            --text-primary: #212121;
            --text-secondary: #757575;
            --divider-color: #BDBDBD;
            --background-color: #F8F9FA;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            margin: 0;
            padding: 0;
            color: var(--text-primary);
            background-color: var(--background-color);
            max-width: 390px; /* iPhone 15 Pro 宽度 */
            margin: 0 auto;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }
        
        /* iPhone 样式的圆角和间距 */
        .app-container {
            border-radius: 0;
            overflow: hidden;
            height: 100%;
            display: flex;
            flex-direction: column;
            border: none;
            position: relative;
        }
        
        /* iOS 状态栏 */
        .status-bar {
            background-color: #000;
            color: white;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .status-bar-content {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* 页面内容 */
        .main-content {
            flex: 1;
            overflow-y: auto;
            background-color: var(--background-color);
            padding-bottom: 70px; /* 底部导航栏的高度 + 间距 */
        }
        
        /* 底部导航栏 */
        .tab-bar {
            height: 60px;
            background-color: white;
            display: flex;
            justify-content: space-around;
            align-items: center;
            position: fixed;
            bottom: 0;
            width: 100%;
            max-width: 390px;
            border-top: 1px solid var(--divider-color);
            z-index: 10;
        }
        
        .tab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 10px;
            padding: 8px 0;
            width: 20%;
            transition: color 0.3s ease;
        }
        
        .tab-item.active {
            color: var(--primary-color);
        }
        
        .tab-icon {
            font-size: 22px;
            margin-bottom: 4px;
            position: relative;
        }
        
        .tab-item.active .tab-icon::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 2px;
            background: var(--primary-color);
        }
        
        /* 顶部导航栏 */
        .nav-bar {
            background-color: var(--primary-color);
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            color: white;
        }
        
        .nav-title {
            font-size: 18px;
            font-weight: 600;
            color: white;
        }
        
        .nav-action {
            position: absolute;
            right: 16px;
            color: white;
            font-size: 18px;
        }
        
        /* 时间周期选择器 */
        .period-selector {
            display: flex;
            padding: 12px 16px;
            background-color: white;
            border-bottom: 1px solid var(--divider-color);
        }
        
        .period-tabs {
            display: flex;
            flex: 1;
            background-color: var(--background-color);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .period-tab {
            flex: 1;
            padding: 8px 0;
            text-align: center;
            font-size: 14px;
            color: var(--text-secondary);
            transition: all 0.3s ease;
        }
        
        .period-tab.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        /* 数据概览卡片 */
        .stats-overview {
            margin: 16px;
            background-color: white;
            border-radius: 4px;
            border: 1px solid var(--divider-color);
            padding: 16px;
        }
        
        .stats-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-primary);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 4px;
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        /* 图表区域 */
        .chart-section {
            margin: 16px;
            background-color: white;
            border-radius: 4px;
            border: 1px solid var(--divider-color);
            padding: 16px;
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .chart-tabs {
            display: flex;
        }
        
        .chart-tab {
            padding: 6px 12px;
            font-size: 14px;
            color: var(--text-secondary);
            border-bottom: 2px solid transparent;
            cursor: pointer;
        }
        
        .chart-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            font-weight: 500;
        }
        
        .chart-container {
            min-height: 200px;
            position: relative;
            margin-top: 16px;
        }
        
        /* 纵向柱状图 */
        .bar-chart {
            height: 200px;
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            padding-top: 20px;
            position: relative;
        }
        
        .bar-container {
            flex: 1;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
        }
        
        .chart-bar {
            width: 20px;
            background-color: var(--primary-color);
            border-radius: 2px 2px 0 0;
            position: relative;
        }
        
        .bar-label {
            font-size: 10px;
            color: var(--text-secondary);
            margin-top: 8px;
            text-align: center;
        }
        
        .bar-value {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: var(--text-secondary);
        }
        
        .chart-axis {
            position: absolute;
            left: 0;
            right: 0;
            bottom: 24px;
            height: 1px;
            background-color: var(--divider-color);
        }
        
        /* 类型分布饼图 */
        .pie-chart {
            width: 200px;
            height: 200px;
            margin: 0 auto;
            position: relative;
            border-radius: 50%;
            overflow: hidden;
            background: conic-gradient(
                #4CAF50 0% 35%,
                #2196F3 35% 55%,
                #FFC107 55% 75%,
                #F44336 75% 85%,
                #9C27B0 85% 100%
            );
            border: 1px solid white;
        }
        
        .pie-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        .pie-percent {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .pie-label {
            font-size: 10px;
            color: var(--text-secondary);
        }
        
        .pie-legend {
            display: flex;
            flex-wrap: wrap;
            margin-top: 24px;
            justify-content: center;
            gap: 12px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-right: 16px;
        }
        
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            margin-right: 6px;
        }
        
        .legend-text {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        /* 热力图 */
        .heatmap {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 6px;
            margin-top: 20px;
        }
        
        .heatmap-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .heatmap-month {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .heatmap-cell {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 2px;
            background-color: #E8F5E9;
            position: relative;
        }
        
        .heatmap-cell.level-0 {
            background-color: #ECEFF1;
        }
        
        .heatmap-cell.level-1 {
            background-color: #E8F5E9;
        }
        
        .heatmap-cell.level-2 {
            background-color: #C8E6C9;
        }
        
        .heatmap-cell.level-3 {
            background-color: #A5D6A7;
        }
        
        .heatmap-cell.level-4 {
            background-color: #81C784;
        }
        
        .heatmap-cell.level-5 {
            background-color: #4CAF50;
        }
        
        .heatmap-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.75);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            visibility: hidden;
            z-index: 10;
        }
        
        .heatmap-cell:hover .heatmap-tooltip {
            visibility: visible;
        }
        
        .weekday-labels {
            position: absolute;
            left: -24px;
            top: 0;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 6px 0;
        }
        
        .weekday-label {
            font-size: 10px;
            color: var(--text-secondary);
        }
        
        /* 任务完成趋势 */
        .trend-section {
            margin: 16px;
            background-color: white;
            border-radius: 4px;
            border: 1px solid var(--divider-color);
            padding: 16px;
        }
        
        .trend-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .trend-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .trend-option {
            font-size: 14px;
            color: var(--primary-color);
        }
        
        .trend-chart {
            height: 160px;
            position: relative;
        }
        
        .trend-line {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* 图线在此处使用SVG或Canvas绘制 */
        }
        
        .trend-line-svg {
            width: 100%;
            height: 100%;
            overflow: visible;
        }
        
        .trend-point {
            fill: var(--primary-color);
            stroke: white;
            stroke-width: 2;
        }
        
        .trend-path {
            fill: none;
            stroke: var(--primary-color);
            stroke-width: 2;
        }
        
        /* 统计卡片 */
        .stat-cards {
            margin: 16px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }
        
        .stat-card {
            background-color: white;
            border-radius: 4px;
            border: 1px solid var(--divider-color);
            padding: 16px;
        }
        
        .stat-card-title {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        
        .stat-card-value {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .stat-card-change {
            display: flex;
            align-items: center;
            font-size: 12px;
        }
        
        .stat-up {
            color: #4CAF50;
        }
        
        .stat-down {
            color: #F44336;
        }
        
        .stat-change-icon {
            margin-right: 4px;
        }
        
        /* 添加任务按钮 */
        .add-task-btn {
            position: fixed;
            bottom: 76px;
            right: 16px;
            width: 52px;
            height: 52px;
            border-radius: 26px;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            z-index: 100;
            transition: background-color 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .add-task-btn:active {
            background-color: var(--primary-dark);
        }
    </style>
    <!-- 引入Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- iOS 状态栏 -->
        <div class="status-bar">
            <div class="status-bar-time">9:41</div>
            <div class="status-bar-content">
                <i class="fas fa-signal"></i>
                <i class="fas fa-wifi"></i>
                <i class="fas fa-battery-full"></i>
            </div>
        </div>
        
        <!-- 顶部导航栏 -->
        <div class="nav-bar">
            <div class="nav-title">统计分析</div>
            <div class="nav-action">
                <i class="fas fa-share-alt"></i>
            </div>
        </div>
        
        <!-- 时间周期选择器 -->
        <div class="period-selector">
            <div class="period-tabs">
                <div class="period-tab">日</div>
                <div class="period-tab active">周</div>
                <div class="period-tab">月</div>
                <div class="period-tab">年</div>
            </div>
        </div>
        
        <!-- 主要内容区域 -->
        <div class="main-content">
            <!-- 完成率统计 -->
            <div class="stats-overview">
                <div class="stats-title">本周概览</div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value">85%</div>
                        <div class="stat-label">总完成率</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">32</div>
                        <div class="stat-label">完成任务</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">6</div>
                        <div class="stat-label">未完成</div>
                    </div>
                </div>
            </div>
            
            <!-- 每日完成情况 -->
            <div class="chart-section">
                <div class="chart-header">
                    <div class="stats-title">每日完成情况</div>
                    <div class="chart-tabs">
                        <div class="chart-tab active">柱状图</div>
                        <div class="chart-tab">折线图</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="bar-chart">
                        <div class="chart-axis"></div>
                        <div class="bar-container">
                            <div class="chart-bar" style="height: 75%;">
                                <div class="bar-value">6/8</div>
                            </div>
                            <div class="bar-label">一</div>
                        </div>
                        <div class="bar-container">
                            <div class="chart-bar" style="height: 87.5%;">
                                <div class="bar-value">7/8</div>
                            </div>
                            <div class="bar-label">二</div>
                        </div>
                        <div class="bar-container">
                            <div class="chart-bar" style="height: 100%;">
                                <div class="bar-value">8/8</div>
                            </div>
                            <div class="bar-label">三</div>
                        </div>
                        <div class="bar-container">
                            <div class="chart-bar" style="height: 62.5%;">
                                <div class="bar-value">5/8</div>
                            </div>
                            <div class="bar-label">四</div>
                        </div>
                        <div class="bar-container">
                            <div class="chart-bar" style="height: 75%;">
                                <div class="bar-value">6/8</div>
                            </div>
                            <div class="bar-label">五</div>
                        </div>
                        <div class="bar-container">
                            <div class="chart-bar" style="height: 50%;">
                                <div class="bar-value">4/8</div>
                            </div>
                            <div class="bar-label">六</div>
                        </div>
                        <div class="bar-container">
                            <div class="chart-bar" style="height: 37.5%;">
                                <div class="bar-value">3/8</div>
                            </div>
                            <div class="bar-label">日</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 分类完成情况 -->
            <div class="chart-section">
                <div class="stats-title">分类完成情况</div>
                <div class="chart-container">
                    <div class="pie-chart">
                        <div class="pie-center">
                            <div class="pie-percent">85%</div>
                            <div class="pie-label">平均完成率</div>
                        </div>
                    </div>
                    
                    <div class="pie-legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #4CAF50;"></div>
                            <div class="legend-text">健身 (90%)</div>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #2196F3;"></div>
                            <div class="legend-text">工作 (80%)</div>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #FFC107;"></div>
                            <div class="legend-text">学习 (75%)</div>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #F44336;"></div>
                            <div class="legend-text">阅读 (60%)</div>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #9C27B0;"></div>
                            <div class="legend-text">其他 (95%)</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 打卡热力图 -->
            <div class="chart-section">
                <div class="stats-title">打卡热力图</div>
                <div class="heatmap-label">
                    <div class="heatmap-month">5月</div>
                </div>
                <div style="position: relative; padding-left: 24px;">
                    <div class="weekday-labels">
                        <div class="weekday-label">一</div>
                        <div class="weekday-label">三</div>
                        <div class="weekday-label">五</div>
                        <div class="weekday-label">日</div>
                    </div>
                    <div class="heatmap">
                        <!-- 第一周 -->
                        <div class="heatmap-cell level-0">
                            <div class="heatmap-tooltip">5/1: 0次打卡</div>
                        </div>
                        <div class="heatmap-cell level-1">
                            <div class="heatmap-tooltip">5/2: 1次打卡</div>
                        </div>
                        <div class="heatmap-cell level-3">
                            <div class="heatmap-tooltip">5/3: 5次打卡</div>
                        </div>
                        <div class="heatmap-cell level-2">
                            <div class="heatmap-tooltip">5/4: 3次打卡</div>
                        </div>
                        <div class="heatmap-cell level-4">
                            <div class="heatmap-tooltip">5/5: 6次打卡</div>
                        </div>
                        <div class="heatmap-cell level-3">
                            <div class="heatmap-tooltip">5/6: 4次打卡</div>
                        </div>
                        <div class="heatmap-cell level-2">
                            <div class="heatmap-tooltip">5/7: 3次打卡</div>
                        </div>
                        
                        <!-- 第二周 -->
                        <div class="heatmap-cell level-5">
                            <div class="heatmap-tooltip">5/8: 8次打卡</div>
                        </div>
                        <div class="heatmap-cell level-4">
                            <div class="heatmap-tooltip">5/9: 7次打卡</div>
                        </div>
                        <div class="heatmap-cell level-5">
                            <div class="heatmap-tooltip">5/10: 8次打卡</div>
                        </div>
                        <div class="heatmap-cell level-3">
                            <div class="heatmap-tooltip">5/11: 5次打卡</div>
                        </div>
                        <div class="heatmap-cell level-4">
                            <div class="heatmap-tooltip">5/12: 6次打卡</div>
                        </div>
                        <div class="heatmap-cell level-2">
                            <div class="heatmap-tooltip">5/13: 4次打卡</div>
                        </div>
                        <div class="heatmap-cell level-1">
                            <div class="heatmap-tooltip">5/14: 3次打卡</div>
                        </div>
                        
                        <!-- 第三周 -->
                        <div class="heatmap-cell level-3">
                            <div class="heatmap-tooltip">5/15: 5次打卡</div>
                        </div>
                        <div class="heatmap-cell level-2">
                            <div class="heatmap-tooltip">5/16: 4次打卡</div>
                        </div>
                        <div class="heatmap-cell level-4">
                            <div class="heatmap-tooltip">5/17: 6次打卡</div>
                        </div>
                        <div class="heatmap-cell level-3">
                            <div class="heatmap-tooltip">5/18: 5次打卡</div>
                        </div>
                        <div class="heatmap-cell level-5">
                            <div class="heatmap-tooltip">5/19: 8次打卡</div>
                        </div>
                        <div class="heatmap-cell level-4">
                            <div class="heatmap-tooltip">5/20: 7次打卡</div>
                        </div>
                        <div class="heatmap-cell level-3">
                            <div class="heatmap-tooltip">5/21: 5次打卡</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 统计卡片 -->
            <div class="stat-cards">
                <div class="stat-card">
                    <div class="stat-card-title">连续打卡</div>
                    <div class="stat-card-value">16天</div>
                    <div class="stat-card-change stat-up">
                        <div class="stat-change-icon"><i class="fas fa-arrow-up"></i></div>
                        <div>较上周 +4天</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-card-title">累计打卡</div>
                    <div class="stat-card-value">125天</div>
                    <div class="stat-card-change stat-up">
                        <div class="stat-change-icon"><i class="fas fa-arrow-up"></i></div>
                        <div>较上月 +18天</div>
                    </div>
                </div>
            </div>
            
            <!-- 完成趋势 -->
            <div class="trend-section">
                <div class="trend-header">
                    <div class="trend-title">完成率趋势</div>
                    <div class="trend-option">
                        近4周
                    </div>
                </div>
                
                <div class="trend-chart">
                    <svg class="trend-line-svg" viewBox="0 0 300 100" preserveAspectRatio="none">
                        <!-- 坐标轴 -->
                        <line x1="0" y1="100" x2="300" y2="100" stroke="#BDBDBD" stroke-width="1"/>
                        
                        <!-- 折线 -->
                        <path d="M0,50 L75,60 L150,30 L225,20 L300,10" class="trend-path"/>
                        
                        <!-- 数据点 -->
                        <circle cx="0" cy="50" r="3" class="trend-point"/>
                        <circle cx="75" cy="60" r="3" class="trend-point"/>
                        <circle cx="150" cy="30" r="3" class="trend-point"/>
                        <circle cx="225" cy="20" r="3" class="trend-point"/>
                        <circle cx="300" cy="10" r="3" class="trend-point"/>
                    </svg>
                </div>
                
                <div class="heatmap-label" style="margin-top: 8px; justify-content: space-around;">
                    <div class="heatmap-month">第1周</div>
                    <div class="heatmap-month">第2周</div>
                    <div class="heatmap-month">第3周</div>
                    <div class="heatmap-month">第4周</div>
                </div>
            </div>
        </div>
        
        <!-- 添加任务按钮 -->
        <a href="create-task.html" class="add-task-btn">
            <i class="fas fa-plus"></i>
        </a>
        
        <!-- 底部标签栏 -->
        <div class="tab-bar">
            <a href="dashboard.html" class="tab-item">
                <div class="tab-icon"><i class="fas fa-home"></i></div>
                <div>首页</div>
            </a>
            <a href="tasks.html" class="tab-item">
                <div class="tab-icon"><i class="fas fa-tasks"></i></div>
                <div>任务</div>
            </a>
            <a href="records.html" class="tab-item">
                <div class="tab-icon"><i class="fas fa-calendar-check"></i></div>
                <div>记录</div>
            </a>
            <a href="statistics.html" class="tab-item active">
                <div class="tab-icon"><i class="fas fa-chart-pie"></i></div>
                <div>统计</div>
            </a>
            <a href="profile.html" class="tab-item">
                <div class="tab-icon"><i class="fas fa-user"></i></div>
                <div>我的</div>
            </a>
        </div>
    </div>

    <script>
        // 时间周期选择
        const periodTabs = document.querySelectorAll('.period-tab');
        periodTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                periodTabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // 在实际应用中，这里应该触发数据重新加载
                console.log('选择了时间周期:', this.textContent);
            });
        });
        
        // 图表类型切换
        const chartTabs = document.querySelectorAll('.chart-tab');
        chartTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const parent = this.closest('.chart-tabs');
                parent.querySelectorAll('.chart-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // 在实际应用中，这里应该切换图表类型的显示
                console.log('切换到图表类型:', this.textContent);
            });
        });
        
        // 热力图单元格交互
        const heatmapCells = document.querySelectorAll('.heatmap-cell');
        heatmapCells.forEach(cell => {
            cell.addEventListener('click', function() {
                // 在实际应用中，点击单元格可以显示该日详细信息
                const tooltip = this.querySelector('.heatmap-tooltip');
                alert('查看详情: ' + tooltip.textContent);
            });
        });
    </script>
</body>
</html> 