# 错误码说明

本文档列出系统中所有的错误码及其含义，帮助前端开发人员理解API返回的错误信息并进行适当的处理。

## 错误码格式

系统错误码采用四位数字编码，格式如下：

- `2xxx`: 成功状态码
- `4xxx`: 客户端错误，表示请求参数错误、权限不足等
- `5xxx`: 服务器错误，表示服务器内部错误

## 成功状态码 (2xxx)

| 错误码 | 描述 | 示例消息 |
|-------|------|---------|
| 2000 | 操作成功 | "操作成功"、"获取成功"、"创建成功" |
| 2001 | 数据已创建 | "数据已创建" |

## 客户端错误码 (4xxx)

| 错误码 | 描述 | 示例消息 |
|-------|------|---------|
| 4000 | 请求参数错误 | "创建失败"、"参数错误" |
| 4001 | 未认证或令牌已过期 | "未认证或令牌已过期" |
| 4002 | 认证失败 | "用户名或密码错误" |
| 4003 | 权限不足 | "无权限执行此操作" |
| 4004 | 资源不存在 | "用户不存在"、"租户不存在" |
| 4005 | 请求方法不允许 | "请求方法不允许" |
| 4006 | 内容类型不支持 | "不支持的内容类型" |
| 4007 | 请求被拒绝 | "请求被拒绝" |
| 4008 | 资源冲突 | "资源已存在" |
| 4009 | 资源已被锁定 | "资源已被锁定" |
| 4010 | 请求频率超限 | "请求过于频繁，请稍后再试" |
| 4011 | 验证码错误 | "验证码错误或已过期" |
| 4012 | 账户状态异常 | "账户已被禁用"、"账户已被锁定" |
| 4013 | 租户状态异常 | "租户已被暂停"、"租户已被删除" |
| 4014 | 配额已满 | "租户用户配额已满"、"租户管理员配额已满" |
| 4015 | 密码强度不足 | "密码必须包含大小写字母、数字和特殊字符" |
| 4016 | 密码不匹配 | "两次输入的密码不一致" |
| 4017 | 旧密码错误 | "旧密码不正确" |

## 服务器错误码 (5xxx)

| 错误码 | 描述 | 示例消息 |
|-------|------|---------|
| 5000 | 服务器内部错误 | "服务器内部错误" |
| 5001 | 服务暂时不可用 | "服务暂时不可用，请稍后再试" |
| 5002 | 网关错误 | "网关错误" |
| 5003 | 服务超时 | "服务请求超时" |
| 5004 | 数据库操作失败 | "数据库操作失败" |
| 5005 | 事务处理失败 | "事务处理失败" |
| 5006 | 外部服务调用失败 | "外部服务调用失败" |
| 5007 | 文件操作失败 | "文件上传失败"、"文件删除失败" |

## 错误响应格式

所有错误响应均遵循以下格式：

```json
{
  "success": false,
  "code": 4xxx or 5xxx,
  "message": "错误描述消息",
  "data": {
    // 可能包含错误详情或错误字段信息
    "field_name": ["字段错误描述"]
  }
}
```

对于表单验证错误，`data` 字段会包含具体的字段错误信息：

```json
{
  "success": false,
  "code": 4000,
  "message": "注册失败",
  "data": {
    "username": ["该租户下此用户名已被使用"],
    "email": ["该租户下此邮箱已被注册"],
    "phone": ["该租户下此手机号已被注册"],
    "password": ["密码过于简单"]
  }
}
```

## 错误处理建议

1. **通用错误处理**：针对通用错误码（如4001、5000等），可以实现统一的错误处理逻辑，如显示全局提示、重定向到登录页面等。

2. **字段错误处理**：针对表单验证错误，可以将错误信息显示在对应的表单字段旁边。

3. **特定错误处理**：针对特定业务错误，如配额已满、租户状态异常等，可以实现特定的错误处理逻辑，如提供升级选项、联系管理员等。

4. **重试机制**：对于网络错误或服务器临时错误，可以实现重试机制，如自动重试或提供重试按钮。

5. **日志记录**：记录前端遇到的错误，便于问题排查和用户反馈处理。 